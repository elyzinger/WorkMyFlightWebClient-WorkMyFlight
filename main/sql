USE [WorkMyFlights]
GO
/****** Object:  StoredProcedure [dbo].[CHECKDEPARTURES_DATETIME]    Script Date: 03/04/2020 00:25:28 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[CHECKDEPARTURES_DATETIME]
AS
BEGIN
 select AirlineCompanies.AIRLINE_NAME,Flights.ID,OC.COUNTRY_NAME AS 'DEPARTING FROM',DC.COUNTRY_NAME AS 'ARRIVING TO', Flights.DEPARTURE_TIME from Flights
  INNER JOIN Countries AS OC ON Flights.ORIGIN_COUNTRY_CODE = oc.ID
  INNER JOIN Countries AS DC ON Flights.DESTINATION_COUNTRY_CODE = DC.ID
  INNER JOIN AirlineCompanies ON Flights.AIRLINE_COMPANY_ID = AirlineCompanies.ID
  where Flights.DEPARTURE_TIME < Flights.LANDING_TIME 
  and DEPARTURE_TIME <= DATEADD(HOUR,12,getdate())
  and DEPARTURE_TIME >= GETDATE() 

END






USE [WorkMyFlights]
GO
/****** Object:  StoredProcedure [dbo].[CHECKLANDINGTIME_DATETIME]    Script Date: 03/04/2020 00:25:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[CHECKLANDINGTIME_DATETIME]

AS
BEGIN

 select AirlineCompanies.AIRLINE_NAME,Flights.ID,OC.COUNTRY_NAME AS 'DEPARTING FROM',DC.COUNTRY_NAME AS 'ARRIVING TO', Flights.LANDING_TIME from Flights
  INNER JOIN Countries AS OC ON Flights.ORIGIN_COUNTRY_CODE = oc.ID
  INNER JOIN Countries AS DC ON Flights.DESTINATION_COUNTRY_CODE = DC.ID
  INNER JOIN AirlineCompanies ON Flights.AIRLINE_COMPANY_ID = AirlineCompanies.ID  
  where Flights.DEPARTURE_TIME < Flights.LANDING_TIME
  and LANDING_TIME <= DATEADD(HOUR,12,getdate())
  and LANDING_TIME >= DATEADD(HOUR, -4, getdate()) 
END
